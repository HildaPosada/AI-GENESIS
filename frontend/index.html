<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Fraud Detection - Protect Your Business</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pulse-glow {
            animation: pulseGlow 2s infinite;
        }
        
        @keyframes pulseGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(102, 126, 234, 0.4); }
            50% { box-shadow: 0 0 30px rgba(102, 126, 234, 0.7); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 min-h-screen text-white">
    <div x-data="fraudDetectionApp()" x-init="init()" class="min-h-screen">
        
        <!-- Navigation -->
        <nav class="fixed top-0 w-full z-50 glass-card">
            <div class="max-w-7xl mx-auto px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center">
                            <i class="fas fa-shield-alt text-white text-xl"></i>
                        </div>
                        <span class="text-xl font-bold gradient-text">FraudShield AI</span>
                    </div>
                    <div class="flex items-center space-x-6">
                        <div class="flex items-center space-x-2">
                            <div :class="apiStatus === 'healthy' ? 'bg-green-400' : 'bg-red-400'" 
                                 class="w-2 h-2 rounded-full pulse-glow"></div>
                            <span class="text-sm text-gray-300" x-text="apiStatus === 'healthy' ? 'All Systems Operational' : 'System Offline'"></span>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <div class="pt-32 pb-20 px-6">
            <div class="max-w-7xl mx-auto text-center fade-in">
                <h1 class="text-6xl font-extrabold mb-6 leading-tight">
                    Detect Fraud in 
                    <span class="gradient-text">Real-Time</span>
                </h1>
                <p class="text-xl text-gray-300 mb-8 max-w-3xl mx-auto">
                    Powered by advanced AI models including Google Gemini, Opus, and Qdrant. 
                    Analyze transactions instantly with multi-model intelligence.
                </p>
                
                <!-- Tech Stack Pills -->
                <div class="flex flex-wrap justify-center gap-3 mb-12">
                    <div class="glass-card px-4 py-2 rounded-full text-sm flex items-center space-x-2">
                        <i class="fas fa-brain text-purple-400"></i>
                        <span>Google Gemini</span>
                    </div>
                    <div class="glass-card px-4 py-2 rounded-full text-sm flex items-center space-x-2">
                        <i class="fas fa-cogs text-blue-400"></i>
                        <span>Opus AI</span>
                    </div>
                    <div class="glass-card px-4 py-2 rounded-full text-sm flex items-center space-x-2">
                        <i class="fas fa-database text-green-400"></i>
                        <span>Qdrant</span>
                    </div>
                    <div class="glass-card px-4 py-2 rounded-full text-sm flex items-center space-x-2">
                        <i class="fas fa-robot text-pink-400"></i>
                        <span>AI/ML API</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="max-w-7xl mx-auto px-6 pb-20">
            <div class="grid lg:grid-cols-3 gap-8">
                
                <!-- Control Panel -->
                <div class="lg:col-span-1">
                    <div class="glass-card rounded-3xl p-8 hover-lift">
                        <h2 class="text-2xl font-bold mb-6">Analyze Transaction</h2>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-3">Transaction Type</label>
                                <select x-model="sampleType" 
                                        class="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 transition">
                                    <option value="normal" class="bg-gray-800">‚úÖ Normal Transaction</option>
                                    <option value="suspicious" class="bg-gray-800">‚ö†Ô∏è Suspicious Activity</option>
                                    <option value="fraud" class="bg-gray-800">üö® Fraudulent</option>
                                </select>
                            </div>
                            
                            <button @click="generateSampleTransaction()" 
                                    :disabled="loading"
                                    class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 disabled:from-gray-600 disabled:to-gray-700 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 disabled:scale-100">
                                <span x-show="!loading" class="flex items-center justify-center space-x-2">
                                    <i class="fas fa-sparkles"></i>
                                    <span>Generate & Analyze</span>
                                </span>
                                <span x-show="loading" class="flex items-center justify-center space-x-2">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <span>Analyzing...</span>
                                </span>
                            </button>
                        </div>

                        <!-- Transaction Preview -->
                        <div x-show="currentTransaction" class="mt-8 pt-8 border-t border-white/10">
                            <h3 class="text-lg font-semibold mb-4">Transaction Details</h3>
                            <div class="space-y-3 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Amount</span>
                                    <span class="font-semibold" x-text="currentTransaction?.amount ? '$' + currentTransaction.amount.toFixed(2) : '-'"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Type</span>
                                    <span class="font-semibold" x-text="currentTransaction?.transaction_type || '-'"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Merchant</span>
                                    <span class="font-semibold" x-text="currentTransaction?.merchant_name || '-'"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results Panel -->
                <div class="lg:col-span-2">
                    <div x-show="analysisResult" class="glass-card rounded-3xl p-8 fade-in">
                        
                        <!-- Risk Score Header -->
                        <div class="mb-8">
                            <div class="flex items-center justify-between mb-4">
                                <h2 class="text-2xl font-bold">Analysis Results</h2>
                                <div x-show="analysisResult?.risk_score !== undefined" :class="{
                                    'bg-green-500/20 text-green-400': analysisResult?.risk_score < 30,
                                    'bg-yellow-500/20 text-yellow-400': analysisResult?.risk_score >= 30 && analysisResult?.risk_score < 70,
                                    'bg-red-500/20 text-red-400': analysisResult?.risk_score >= 70
                                }" class="px-4 py-2 rounded-xl font-bold flex items-center space-x-2">
                                    <span x-text="analysisResult?.risk_score + '%'"></span>
                                    <span x-text="analysisResult?.is_fraud ? 'üö®' : '‚úÖ'"></span>
                                </div>
                            </div>
                            
                            <!-- Risk Level Bar -->
                            <div x-show="analysisResult?.risk_score !== undefined" class="relative h-3 bg-white/10 rounded-full overflow-hidden">
                                <div :style="`width: ${analysisResult?.risk_score || 0}%`"
                                     :class="{
                                         'bg-gradient-to-r from-green-400 to-green-500': analysisResult?.risk_score < 30,
                                         'bg-gradient-to-r from-yellow-400 to-orange-500': analysisResult?.risk_score >= 30 && analysisResult?.risk_score < 70,
                                         'bg-gradient-to-r from-red-400 to-red-600': analysisResult?.risk_score >= 70
                                     }"
                                     class="h-full transition-all duration-1000 ease-out"></div>
                            </div>
                            <div class="flex justify-between text-xs text-gray-400 mt-2">
                                <span>Low Risk</span>
                                <span>High Risk</span>
                            </div>
                        </div>

                        <!-- Risk Factors -->
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold mb-4">Risk Factors</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <template x-for="(factor, index) in analysisResult?.risk_factors" :key="index">
                                    <div class="bg-white/5 rounded-xl p-4 border border-white/10">
                                        <div class="text-sm text-gray-400 mb-1">Factor</div>
                                        <div class="font-semibold" x-text="factor"></div>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- AI Insights -->
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold mb-4 flex items-center space-x-2">
                                <i class="fas fa-lightbulb text-yellow-400"></i>
                                <span>AI-Powered Insights</span>
                            </h3>
                            <div class="bg-purple-500/10 border border-purple-500/30 rounded-xl p-6">
                                <p class="text-gray-300 leading-relaxed" x-text="analysisResult?.explanation || 'Analyzing transaction patterns...'"></p>
                            </div>
                        </div>

                        <!-- Recommendations -->
                        <div x-show="analysisResult?.recommendations?.length > 0">
                            <h3 class="text-lg font-semibold mb-4">Recommended Actions</h3>
                            <div class="space-y-3">
                                <template x-for="(rec, index) in analysisResult?.recommendations" :key="index">
                                    <div class="flex items-start space-x-3 bg-blue-500/10 border border-blue-500/30 rounded-xl p-4">
                                        <i class="fas fa-check-circle text-blue-400 mt-1"></i>
                                        <span class="text-gray-300" x-text="rec"></span>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Technology Details -->
                        <div class="mt-8 pt-8 border-t border-white/10">
                            <h3 class="text-sm font-semibold text-gray-400 mb-4">POWERED BY</h3>
                            <div class="grid grid-cols-4 gap-4">
                                <div class="text-center">
                                    <div class="w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center mx-auto mb-2">
                                        <i class="fas fa-brain text-purple-400"></i>
                                    </div>
                                    <div class="text-xs text-gray-400">Gemini</div>
                                </div>
                                <div class="text-center">
                                    <div class="w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center mx-auto mb-2">
                                        <i class="fas fa-cogs text-blue-400"></i>
                                    </div>
                                    <div class="text-xs text-gray-400">Opus</div>
                                </div>
                                <div class="text-center">
                                    <div class="w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center mx-auto mb-2">
                                        <i class="fas fa-database text-green-400"></i>
                                    </div>
                                    <div class="text-xs text-gray-400">Qdrant</div>
                                </div>
                                <div class="text-center">
                                    <div class="w-12 h-12 bg-pink-500/20 rounded-xl flex items-center justify-center mx-auto mb-2">
                                        <i class="fas fa-robot text-pink-400"></i>
                                    </div>
                                    <div class="text-xs text-gray-400">AI/ML</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Empty State -->
                    <div x-show="!analysisResult" class="glass-card rounded-3xl p-16 text-center">
                        <div class="w-24 h-24 bg-purple-500/20 rounded-full flex items-center justify-center mx-auto mb-6">
                            <i class="fas fa-chart-line text-5xl text-purple-400"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Ready to Analyze</h3>
                        <p class="text-gray-400">Select a transaction type and click "Generate & Analyze" to see AI-powered fraud detection in action.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="border-t border-white/10 mt-20">
            <div class="max-w-7xl mx-auto px-6 py-8 text-center text-gray-400 text-sm">
                <p>Built for AI Genesis Hackathon 2025 | Powered by Google Gemini, Opus, Qdrant & AI/ML API</p>
            </div>
        </footer>
    </div>

    <script>
        function fraudDetectionApp() {
            return {
                activeTab: 'transaction',
                apiStatus: 'checking',
                loading: false,
                sampleType: 'normal',
                currentTransaction: null,
                analysisResult: null,

                // Auto-detect API URL for GitHub Codespaces or localhost
                getApiUrl() {
                    // If running in Codespaces, use the forwarded port URL
                    if (window.location.hostname.includes('github.dev') || window.location.hostname.includes('githubpreview.dev')) {
                        // Build the backend URL by replacing the port in hostname
                        const backendHostname = window.location.hostname.replace('-3000.', '-8000.');
                        return `${window.location.protocol}//${backendHostname}`;
                    }
                    // Default to localhost for local development
                    return 'http://localhost:8000';
                },

                async init() {
                    console.log('API URL:', this.getApiUrl());
                    await this.checkHealth();
                },

                async checkHealth() {
                    try {
                        const response = await fetch(`${this.getApiUrl()}/api/health`);
                        const data = await response.json();
                        this.apiStatus = data.status;
                    } catch (error) {
                        this.apiStatus = 'offline';
                        console.error('Health check failed:', error);
                    }
                },

                async generateSampleTransaction() {
                    this.loading = true;
                    this.analysisResult = null;

                    try {
                        // Generate sample transaction
                        const sampleResponse = await fetch(`${this.getApiUrl()}/api/demo/generate-sample-transaction?fraud_type=${this.sampleType}`, {
                            method: 'POST'
                        });
                        this.currentTransaction = await sampleResponse.json();

                        // Analyze transaction
                        const analysisResponse = await fetch(`${this.getApiUrl()}/api/analyze/transaction`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(this.currentTransaction)
                        });
                        this.analysisResult = await analysisResponse.json();

                    } catch (error) {
                        console.error('Analysis failed:', error);
                        alert('Analysis failed. Make sure the backend is running on port 8000.');
                    } finally {
                        this.loading = false;
                    }
                }
            }
        }
    </script>
</body>
</html>
